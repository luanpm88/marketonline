<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>{$page_title}</title>
    
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    
    <!-- Bootstrap core CSS -->
    <link href="{the_url module=root-url}{$theme_img_path}modern/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="{the_url module=root-url}{$theme_img_path}modern/css/custom.css" rel="stylesheet">
    <link href="{the_url module=root-url}{$theme_img_path}modern/css/custom_media.css" rel="stylesheet">
    <link href="{the_url module=root-url}{$theme_img_path}modern/css/glyphicons.css" rel="stylesheet">
    
    <!-- Custom styles for this template -->
    <link href="jumbotron.css" rel="stylesheet">
      
    <script type="text/javascript" src="{the_url module=root-url}{$theme_img_path}modern/js/holder.js"></script>
    
    <script type="text/javascript" src="{the_url module=root-url}{$theme_img_path}modern/tinymce/tinymce.min.js"></script>
    
    <script type="text/javascript" src="{the_url module=root-url}{$theme_img_path}modern/js/jemotion/jemotion.js"></script>
    
    <script type="text/javascript" src="{the_url module=root-url}{$theme_img_path}modern/js/chat_script.js"></script>
    
    <script type="text/javascript" src="{the_url module=root-url}{$theme_img_path}modern/js/jquery.cookie.js"></script>
    
    {literal}
    <script type="text/javascript">
        var ROOT_URL = '{/literal}{the_url module=root-url}{literal}';
        var ichatbox = new Array();        
        var on_page = 1;
        
        var keytimeout;
        function goSearch() {
	    if ($('.top-search-input').val().trim() != '') {
                $('.top-search-result-box .panel-body').html('<div class="no-search-top search-loading">Loading</div>');
                $('.top-search-result-box').show();
                
                fullTextSearch( $('.top-search-input').val() );
            } else {
                $('.top-search-result-box').hide();
            }
	}
        
        //full text search
        var ajaxSearch_xhr;
	function fullTextSearch(keyword) {
            var search_type = $('.top-search-type').attr("rel");
            
	    if(ajaxSearch_xhr && ajaxSearch_xhr.readystate != 4){
		ajaxSearch_xhr.abort();
	    }
        
		ajaxSearch_xhr = $.ajax({
		    url: ROOT_URL+"index.php?do=product&action=ajaxModernSearch&type="+search_type+"&keyword="+encodeURIComponent(keyword)
		}).done(function ( data ) {
		    if( console && console.log ) {
                        
                        $('.top-search-result-box .panel-body').html(data);
                        
			//if (data != "") {
			//	$('#TopSearch .search_result').html(data);
			//	$('#TopSearch .search_result').css("display", "block");
			//	
			//	$('#TopSearch .search_result ul li:first-child').addClass("active");
			//	
			//	$('#TopSearch .search_result ul li').hover(function () {
			//	    $('#TopSearch .search_result ul li:first-child').removeClass("active");
			//	    $(this).addClass("active");
			//	},function () {
			//	    $('#TopSearch .search_result ul li').removeClass("active");
			//	    $('#TopSearch .search_result ul li:first-child').addClass("active");
			//	});
			//	
			//	//cart product image
			//	$('#TopSearch .search_result ul.shop img').resizecrop({
			//	   width:50,
			//	   height:50
			//	});
			//	$('#TopSearch .search_result ul.product img').resizecrop({
			//	   width:74,
			//	   height:74
			//	});
			//	
			//	if(!$('#TopSearch .search-scroll').hasClass("mCustomScrollbar"))
			//	{
			//	    $('#TopSearch .search-scroll').mCustomScrollbar({
			//		autoHideScrollbar:true,
			//		theme:"light-thin",
			//		scrollSpeed: 40
			//	    });
			//	}
			//    }
			//    else
			//    {
			//	$('#TopSearch .search_result').css("display", "none");
			//    }
		    }
		});
	}
        
        
        
        function getTopCart()
	{
	    $.ajax({
                url: ROOT_URL+"index.php?do=product&action=ajaxTopCart",
            }).done(function ( data ) {
                if( console && console.log ) {
                    var content = $("<div>").html(data);
                    $('.top_cart .badge').html(content.find('#cart_count').html());
                }
            });
	}
        
        function refreshTopCompanyStatistic(p_id)
	{
	    //alert(p_id);
	    $.ajax({
			url: ROOT_URL+"index.php?do=company&action=refreshTopCompanyStatistic&id="+p_id,
		}).done(function ( data ) {
			if( console && console.log ) {
			    $('.top_statistic .badge').html("");
                            $('.top_statistic .top_statistic_content').html(data);
			}
		});
	}
        
        function getTopCompanyStatistic(p_id) {
            $.ajax({
                    url: ROOT_URL+"index.php?do=company&action=ajaxTopCompanyStatistic&id="+p_id,
            }).done(function ( data ) {
                    if( console && console.log ) {
                            //alert(data);
                            //$('.staticon').append(data);
                            
                            var content = $("<div>").html(data);
                            $('.top_statistic .badge').html(content.find('.outcount span').html());
                            $('.top_statistic .top_statistic_content').html(content.find('.clicked_note_box').clone());
                    }
            });
	}
        
        var ajaxTopMailbox_xhr;
        function ajaxTopMailbox() {
            if(ajaxTopMailbox_xhr && ajaxTopMailbox_xhr.readystate != 4){
                    ajaxTopMailbox_xhr.abort();
            }
            //code
            ajaxTopMailbox_xhr = $.ajax({
                    url: ROOT_URL+"index.php?do=message&action=ajaxTopMailbox",
            }).done(function ( data ) {
                    if( console && console.log ) {
                        $(".top_mailbox_content").html(data);
                    }
            });
        }
        
        var ajaxTopChatbox_xhr;
        var chat_page = 1;
        var chat_scroll = true;
        function ajaxTopChatbox() {
            if(ajaxTopChatbox_xhr && ajaxTopChatbox_xhr.readystate != 4){
                ajaxTopChatbox_xhr.abort();
            }
            //code
            ajaxTopChatbox_xhr = $.ajax({
                url: ROOT_URL+"index.php?do=chatc&action=ajaxTopChatbox",
            }).done(function ( data ) {
                if( console && console.log ) {
                    $(".top_chatbox_content").html(data);
                    
                    $(".top_chatbox_content .panel-body").scroll( function() {
                        var distance = $(".top_chatbox_content .panel-body ul li").last().offset().top -
                                    $(".top_chatbox_content").last().offset().top - 
                                    $(".top_chatbox_content").last().height();
                        if (distance < 100 && chat_scroll) {
                            chat_scroll = false;
                            ajaxTopChatboxScroll();
                        }
                    });
                }
            });
        }
        function ajaxTopChatboxScroll() {
            $.ajax({
                    url: ROOT_URL+"index.php?do=chatc&action=ajaxTopChatbox&page="+chat_page,
            }).done(function ( data ) {
                    if( console && console.log ) {                        
                        if (!$("<div>").html(data).find('.noitem').length) {
                            chat_scroll = true;
                            chat_page += 1;
                            $('.top_chatbox_content .panel-body ul').append($("<div>").html(data).find('.panel-body ul').html());
                        }
                    }
            });
        }
        
        
        
        
        
    
    $(document).ready(function() {
        tinymce.init({
            selector: "#main-editor",
            language: "vi_VN",
            
            menubar: "",
            plugins: [
                "image,table,wordcount"
            ],
            toolbar: "table image | styleselect | bold italic underline | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link",
  
  
  
            content_css: "{/literal}{the_url module=root-url}{$theme_img_path}{literal}modern/bootstrap/css/bootstrap.min.css,{/literal}{the_url module=root-url}{$theme_img_path}{literal}modern/css/custom_editor.css",
            relative_urls : false,
            remove_script_host : false,
            convert_urls : true,
            setup: function(editor) {           
              editor.on('focus', function(e) {
                var editor_box = $('#main-editor').parents('.main-text-editor');
                editor_box.removeClass('hide-control');
              });
              editor.on('blur', function(e) {
                var editor_box = $('#main-editor').parents('.main-text-editor');
                editor_box.addClass('hide-control');
                if(tinyMCE.get('main-editor').getContent() != "") {
                  editor_box.find('.placeholder').hide();
                } else {
                  editor_box.find('.placeholder').show();
                }
              });
              
          }
        
        });
            
            
        //--------------TOP SEARCH ACTIONS------------------------//
        
        $('.top-search-form .dropdown-menu li').click(function() {
            $('.top-search-type').removeClass("shop","fins");
            $('.top-search-type').addClass($(this).attr("icon-rel"));
            $('.top-search-type').attr("rel",$(this).attr("rel"));
            $('.top-search-input').attr("placeholder",$(this).attr("holder-rel"));
            
            goSearch();
        });            
        $('.top-search-input').on("keyup", function(event){
            $('.top-search-input').val($(this).val());
            goSearch();
        });
        $('.top-search-input').on("focus", function(event){
            goSearch();
        });
        $('.page').on("click", function(event){
            $('.top-search-result-box').hide();
        });
        
        ///////////////////////////////////////////////////////////
            
            
            
            
            
            
        
        
        
    });
    </script>
    {/literal}
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>